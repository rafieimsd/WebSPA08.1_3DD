CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE CACHED TABLE USERS(USID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,FULLNAME VARCHAR(255),EMAIL VARCHAR(255),PHONE VARCHAR(25),ACTIVE BOOLEAN DEFAULT FALSE NOT NULL,CREATED TIMESTAMP NOT NULL,MODIFIED TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL)
CREATE CACHED TABLE USERNAMES(USNID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,USERNAME VARCHAR(64), USID INTEGER,CREATED TIMESTAMP NOT NULL, CONSTRAINT SYS_FK_80 FOREIGN KEY(USID) REFERENCES USERS(USID))
CREATE CACHED TABLE PASSPHRASES(PPID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,USID INTEGER,PASSPHRASE VARCHAR(255) NOT NULL,CREATED TIMESTAMP NOT NULL,MODIFIED TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,CONSTRAINT SYS_FK_48 FOREIGN KEY(USID) REFERENCES USERS(USID))
CREATE CACHED TABLE ACTIONS_AVAILABLE(AAID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,USID INTEGER,ACTION_NUMBER INTEGER NOT NULL,COMMAND VARCHAR(255) NOT NULL,LAST_EXECUTED TIMESTAMP,LAST_RUN_SUCCESS BOOLEAN,IP_ADDR VARCHAR(255),CONSTRAINT SYS_FK_53 FOREIGN KEY(USID) REFERENCES USERS(USID))
CREATE CACHED TABLE ACTIONS_RECEIVED(ARID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,IP_ADDR VARCHAR(25),RECEIVED TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,KNOCK VARCHAR(100) NOT NULL,AAID INTEGER,CONSTRAINT SYS_FK_60 FOREIGN KEY(AAID) REFERENCES ACTIONS_AVAILABLE(AAID))
CREATE CACHED TABLE USERS_VALIDATION_QUEUE(USID INTEGER ,P_INDEX INTEGER,IS_VALID BOOLEAN DEFAULT FALSE NOT NULL,IS_WAITING BOOLEAN,CREATED TIMESTAMP NOT NULL,MODIFIED TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL)
ALTER TABLE PASSPHRASES ALTER COLUMN PPID RESTART WITH 11
ALTER TABLE USERS ALTER COLUMN USID RESTART WITH 11
ALTER TABLE ACTIONS_AVAILABLE ALTER COLUMN AAID RESTART WITH 1
ALTER TABLE ACTIONS_RECEIVED ALTER COLUMN ARID RESTART WITH 1
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 10
